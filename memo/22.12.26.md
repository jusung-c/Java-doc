## [JAVA 미니프로젝트] 회원관리 프로그램

#### 기능

1. 회원 등록
2. 회원 목록 보기
3. 회원 수정
4. 회원 삭제
5. 종료

* 프로그램을 실행하면 /tmp/user.dat 파일에서 회원정보를 읽어온다.
* 해당 파일이 없을 경우 읽어오지 않는다.
* 프로그램 종료시, 메모리에 있는 회원 정보를 /tmp/users.dat에 저장한다.
* 프로그램을 강제 종료하면 저장이 안될 수 있다.


#### 회원 등록 구현

```
email을 입력하세요: admin@naver.com

이름을 입력하세요: JS

생년을 입력하세요: 1999

등록되었습니다...
```


#### 회원 목록 보기

```
email: admin@naver.com

이름: JS

생년: 1999
```


#### 설계 스케치

![image.png](assets/image-mini.png)




#### User

```java
public class User implements Serializable {
    private String email;
    private String name;
    private int birthYear;

    public User(String email, String name, int birthYear) {
        this.email = email;
        this.name = name;
        this.birthYear = birthYear;
    }

    public String getEmail() {
        return email;
    }

    public String getName() {
        return name;
    }

    public int getBirthYear() {
        return birthYear;
    }

    @Override
    public String toString() {
        return "User{" +
                "email='" + email + '\'' +
                ", name='" + name + '\'' +
                ", birthYear=" + birthYear +
                '}';
    }
}

```


#### UserDao

- saveUser(파일명) : 파일에 User 정보 등록
- loadUSer(): User 정보 읽어오기

```java
public class UserDao {
    private  String filename;

    public UserDao(String filename) {
        this.filename = filename;
    }

    public void saveUser(List<User> userList) {
        try(ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(filename))) {
            out.writeObject(userList);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public List<User> loadUser() {
        File file = new File(filename);

        // 파일이 존재하는 지 확인
        if (!file.exists()) {
            return new ArrayList<>();
        }

        List<User> list = null;
        try (ObjectInputStream in = new ObjectInputStream(new FileInputStream(filename))) {
             list = (List<User>) in.readObject();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return list;
    }
}
```


#### UserUI

```java
public class UserUI {
    private BufferedReader br;

    public UserUI() {
        br = new BufferedReader(new InputStreamReader(System.in));
    }

    public int menu() throws IOException {
        System.out.println("1. 회원 등록");
        System.out.println("2. 회원 목록 보기");
        System.out.println("3. 프로그램 종료");

        String line = br.readLine();
        return Integer.parseInt(line);
    }

    // User 등록
    public User regMenu() {
        try {
            System.out.print("email을 입력하세요: ");
            String email = br.readLine();
            System.out.print("이름을 입력하세요: ");
            String name = br.readLine();
            System.out.print("생년을 입력하세요: ");
            int birthYear = Integer.parseInt(br.readLine());

            User user = new User(email, name, birthYear);
            return user;

        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }

    // User 목록 보기
    public void listUser(List<User> users) {
        System.out.println("email           이름          생년");
        System.out.println("================================");
        for (User user : users) {
            System.out.print(user.getEmail());
            System.out.print("      ");
            System.out.print(user.getName());
            System.out.print("      ");
            System.out.print(user.getBirthYear());
            System.out.print("      ");
        }
    } 
}

```


#### UserMain

```java
public class UserMain {
    public static void main(String[] args) {
        UserUI userUI = new UserUI();
        UserDao userDao = new UserDao("/tmp/users.dat");
        List<User> users = userDao.loadUsers();

        // 메뉴
        while (true) {
            int menuId = userUI.menu();

            // 프로그램 종료
            if (menuId == 5) {
                System.out.println("프로그램을 종료합니다.");
                userDao.saveUser(users);
                break;

            // User 등록
            } else if (menuId == 1) {
                User user = userUI.regUser();
                users.add(user);
                System.out.println("등록이 완료되었습니다.");

            // User 목록 보기
            } else if (menuId == 2) {
                userUI.listUser(users);
            }
        }

    }
}

```


### User 수정

수정할 회원의 email을 입력 받기

* email 주소가 메모리상의 회원정보에 있을 경우: 수정
* email 주소가 메모리상의 회원정보에 없을 경우: "존재하지 않는 회원입니다."


```java
public void updateUser(List<User> users) {
        try {
            System.out.print("수정할 회원의 email을 입력하세요: ");
            String userEmail = br.readLine();

            int a = 0;

            for (int i = 0; i < users.size(); i++) {
                if (users.get(i).getEmail().equals(userEmail)) {
                    System.out.println(userEmail + " 회원의 정보를 수정합니다.");
                    System.out.print("이름을 입력하시오: ");
                    String updateName = br.readLine();
                    System.out.print("생년을 입력하시오: ");
                    int updateBirthYear = Integer.parseInt(br.readLine());

                    users.remove(i);
                    users.add(new User(userEmail, updateName, updateBirthYear));
                    a=1;
                    System.out.println("수정이 완료되었습니다.");
                }
            }

            if (a == 0) {
                System.out.println("존재하지 않는 User 입니다.");
            }
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
```


### User 삭제

```java
public void removeUser(List<User> users) {
        try {
            System.out.print("삭제할 회원의 email을 입력하세요: ");
            String userEmail = br.readLine();
            int a=0;

            for (int i = 0; i < users.size(); i++) {
                if (users.get(i).getEmail().equals(userEmail)) {

                    users.remove(i);
                    a = 1;
                    System.out.println("삭제가 완료되었습니다.");
                }
            }

            if (a==0) System.out.println("존재하지 않는 User입니다.");
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
```


## 코드 리펙토링
